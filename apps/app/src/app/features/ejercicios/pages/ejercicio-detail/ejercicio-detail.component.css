@reference "tailwindcss";

/* === Variables === */
:host {
  --kengo-primary: #e75c3e;
  --kengo-glass: rgba(255, 255, 255, 0.65);
  --kengo-border: rgba(255, 255, 255, 0.3);
  --kengo-shadow-primary: 0 6px 24px rgba(231, 92, 62, 0.4);
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --transition: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  display: block;
  position: fixed;
  inset: 0;
  z-index: 100;
}

.exercise-page {
  @apply relative flex flex-col w-full h-full overflow-hidden;
  background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
}

/* === Aurora === */
.aurora-bg { @apply absolute inset-0 pointer-events-none overflow-hidden opacity-30; }
.aurora-wave { @apply absolute rounded-full; filter: blur(80px); mix-blend-mode: screen; }
.aurora-wave-1 {
  @apply w-[400px] h-[400px] -top-32 -right-32;
  background: radial-gradient(circle, rgba(231, 92, 62, 0.5) 0%, transparent 70%);
  animation: auroraFloat1 15s ease-in-out infinite;
}
.aurora-wave-2 {
  @apply w-[300px] h-[300px] bottom-40 -left-20;
  background: radial-gradient(circle, rgba(239, 192, 72, 0.4) 0%, transparent 70%);
  animation: auroraFloat2 12s ease-in-out infinite;
}
@keyframes auroraFloat1 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-40px, 60px) scale(1.2); } }
@keyframes auroraFloat2 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(50px, -40px) scale(1.15); } }

/* === States === */
.loading-container, .error-container { @apply flex-1 flex items-center justify-center p-6; }
.loading-card, .error-card {
  @apply relative p-12 rounded-3xl text-center overflow-hidden;
  background: var(--kengo-glass);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--kengo-border);
}
.shimmer-effect {
  @apply absolute inset-0;
  background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%);
  background-size: 200% 100%;
  animation: shimmer 1.8s infinite;
}
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
.loading-icon, .error-icon {
  @apply w-20 h-20 mx-auto rounded-2xl flex items-center justify-center;
  background: linear-gradient(135deg, rgba(231, 92, 62, 0.15) 0%, rgba(239, 192, 72, 0.1) 100%);
}
.loading-icon { animation: pulse 2s ease-in-out infinite; }
.loading-icon .material-symbols-outlined, .error-icon .material-symbols-outlined { @apply text-5xl text-[#e75c3e]; }
.error-icon { @apply bg-red-50; }
.error-icon .material-symbols-outlined { @apply text-red-400; }
@keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); opacity: 0.7; } }
.loading-text { @apply relative text-sm text-zinc-500 mt-5 font-medium; }
.error-text { @apply text-zinc-600 mt-4 mb-6; }
.error-btn { @apply inline-flex items-center gap-2 px-5 py-3 rounded-xl border-[1.5px] border-zinc-300 text-zinc-700 font-medium cursor-pointer transition-all; }
.error-btn:hover { @apply border-[#e75c3e] text-[#e75c3e]; }

/* === Header === */
.floating-header {
  @apply absolute top-0 left-0 right-0 z-50 flex items-center justify-between;
  padding: calc(var(--safe-top) + 12px) 16px 12px;
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.5) 0%, transparent 100%);
  transition: background var(--transition);
}
.floating-header.scrolled { background: linear-gradient(180deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.3) 100%); }
.header-btn {
  @apply flex items-center justify-center w-11 h-11 rounded-full cursor-pointer transition-all active:scale-90;
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}
.header-btn .material-symbols-outlined { @apply text-white text-xl; }
.header-btn:hover { background: rgba(255, 255, 255, 0.25); transform: scale(1.05); }
.header-center { @apply flex-1 mx-4 text-center opacity-0; transform: translateY(-8px); transition: all var(--transition); }
.header-center.visible { @apply opacity-100; transform: translateY(0); }
.header-title { @apply text-white text-lg truncate; }

/* === Media === */
.media-container { @apply relative flex-shrink-0 overflow-hidden cursor-pointer; height: 55dvh; transition: height var(--transition); }
.media-container.expanded { height: calc(100dvh - 120px - var(--safe-bottom)); }
.media-video, .media-image { @apply absolute inset-0 w-full h-full object-cover; transition: transform 0.6s ease; }
.media-container:hover .media-video, .media-container:hover .media-image { transform: scale(1.02); }
.media-placeholder { @apply flex items-center justify-center w-full h-full; background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%); }
.media-placeholder .material-symbols-outlined { @apply text-8xl text-zinc-700; }
.media-overlay { @apply absolute inset-0 pointer-events-none; background: linear-gradient(180deg, transparent 0%, transparent 50%, rgba(0, 0, 0, 0.4) 80%, rgba(0, 0, 0, 0.7) 100%); }
.play-indicator { @apply absolute inset-0 flex items-center justify-center pointer-events-none; animation: playPop 0.6s ease-out forwards; }
.play-indicator .material-symbols-outlined { @apply text-white; font-size: 5rem; text-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); }
@keyframes playPop { 0% { opacity: 0; transform: scale(0.5); } 30% { opacity: 1; transform: scale(1.1); } 100% { opacity: 0; transform: scale(1.3); } }
.swipe-hint { @apply absolute bottom-10 inset-x-0 flex flex-col items-center gap-1 text-white/70 pointer-events-none; animation: hintBounce 2s ease-in-out infinite; }
.swipe-hint .material-symbols-outlined { @apply text-2xl; }
.hint-text { @apply text-xs font-medium; }
@keyframes hintBounce { 0%, 100% { transform: translateY(0); opacity: 0.7; } 50% { transform: translateY(-8px); opacity: 1; } }

/* === Bottom Panel === */
.bottom-panel {
  @apply relative flex-1 flex flex-col z-10 overflow-hidden;
  border-radius: 28px 28px 0 0;
  background: var(--kengo-glass);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border: 1px solid var(--kengo-border);
  border-bottom: none;
  box-shadow: 0 -8px 40px rgba(0, 0, 0, 0.15);
  margin-top: -24px;
  transition: all var(--transition);
}
.bottom-panel.minimized { @apply flex-shrink-0; flex: 0 0 auto; }
.panel-handle { @apply flex justify-center py-3 cursor-pointer; }
.handle-bar { @apply w-12 h-1.5 rounded-full bg-zinc-300/60; transition: all 0.2s ease; }
.panel-handle:hover .handle-bar { @apply bg-zinc-400 w-16; }

/* === Content === */
.exercise-content { @apply flex-1 overflow-y-auto px-5 pb-4; scrollbar-width: none; -ms-overflow-style: none; }
.exercise-content::-webkit-scrollbar { display: none; }
.animate-content { animation: slideUp 0.4s ease-out; }
@keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.exercise-header { @apply text-center mb-5; }
.exercise-title { @apply text-2xl text-[#e75c3e] mb-3; }
.exercise-meta { @apply inline-flex items-center gap-2 px-4 py-2 rounded-2xl; background: rgba(231, 92, 62, 0.08); border: 1px solid rgba(231, 92, 62, 0.15); }
.meta-badge { @apply inline-flex items-center gap-1.5 text-sm font-semibold text-zinc-700; }
.meta-badge .material-symbols-outlined { @apply text-base text-[#e75c3e]; }
.meta-divider { @apply text-zinc-400 font-bold; }

/* === Duration === */
.duration-selector { @apply flex flex-col items-center gap-3 mb-5; }
.duration-label { @apply text-xs font-semibold text-zinc-400 uppercase tracking-wider; }
.duration-chips { @apply flex items-center gap-2; }
.duration-chip { @apply px-4 py-2 rounded-full text-sm font-semibold cursor-pointer transition-all active:scale-95; background: rgba(255, 255, 255, 0.6); border: 1.5px solid rgba(0, 0, 0, 0.08); color: #64748b; }
.duration-chip:hover { background: rgba(255, 255, 255, 0.9); border-color: rgba(231, 92, 62, 0.3); color: #e75c3e; }
.duration-chip.active { background: linear-gradient(135deg, #e75c3e 0%, #c94a2f 100%); border-color: transparent; color: white; box-shadow: var(--kengo-shadow-primary); }

/* === Description === */
.description-card { @apply rounded-2xl overflow-hidden; background: rgba(255, 255, 255, 0.5); border: 1px solid rgba(255, 255, 255, 0.4); }
.description-header { @apply flex items-center gap-2 px-4 py-3 text-sm font-semibold text-zinc-600; background: rgba(255, 255, 255, 0.4); border-bottom: 1px solid rgba(0, 0, 0, 0.05); }
.description-header .material-symbols-outlined { @apply text-lg text-[#e75c3e]; }
.description-content { @apply px-4 py-3 text-sm text-zinc-600 leading-relaxed; }
.description-content p { @apply mb-2 last:mb-0; }

/* === Actions === */
.actions-bar { @apply flex items-center justify-center gap-4 px-5 py-4 shrink-0; padding-bottom: calc(var(--safe-bottom) + 16px); transition: all var(--transition); }
.actions-bar.compact { @apply flex-col gap-3 py-3; padding-bottom: calc(var(--safe-bottom) + 12px); }
.minimal-info { @apply w-full text-center mb-1; }
.minimal-title { @apply text-base font-semibold text-zinc-700 truncate block px-4; }
.action-buttons { @apply flex items-center justify-center gap-4; }
.action-btn { @apply flex items-center justify-center gap-2 cursor-pointer transition-all active:scale-95; border: none; }
.action-btn.secondary { @apply w-12 h-12 rounded-full; background: rgba(255, 255, 255, 0.7); border: 1px solid rgba(0, 0, 0, 0.08); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
.action-btn.secondary .material-symbols-outlined { @apply text-xl text-zinc-600; }
.action-btn.secondary:hover { background: rgba(255, 255, 255, 0.95); transform: translateY(-2px); }
.action-btn.secondary:hover .material-symbols-outlined { @apply text-[#e75c3e]; }
.action-btn.primary { @apply h-14 px-6 rounded-2xl text-white font-semibold; background: linear-gradient(135deg, #e75c3e 0%, #c94a2f 100%); box-shadow: var(--kengo-shadow-primary); }
.action-btn.primary .material-symbols-outlined { @apply text-2xl; }
.action-btn.primary:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 8px 28px rgba(231, 92, 62, 0.5); }
.btn-label { @apply text-base; }
.actions-bar.compact .action-btn.primary { @apply w-16 h-16 px-0 rounded-full; }
.actions-bar.compact .action-btn.primary .btn-label { @apply hidden; }

.icon-filled { font-variation-settings: "FILL" 1, "wght" 400, "GRAD" 0, "opsz" 24; }

/* === Desktop === */
@media (min-width: 768px) {
  .media-container { height: 60dvh; }
  .media-container.expanded { height: calc(100dvh - 140px); }
  .bottom-panel { @apply max-w-2xl mx-auto; border-radius: 32px 32px 0 0; }
  .exercise-content { @apply px-8; }
  .exercise-title { @apply text-3xl; }
  .duration-chip { @apply px-6 py-2.5 text-base; }
  .actions-bar { @apply gap-6 py-6; }
  .action-btn.secondary { @apply w-14 h-14; }
  .action-btn.primary { @apply h-16 px-8; }
}
