<section
  class="absolute top-0 left-0 flex h-dvh w-screen items-center justify-center"
>
  <div
    class="flex w-80 flex-col justify-center rounded-2xl border-white/20 bg-white/60 px-6 py-3 shadow-xl backdrop-blur-md backdrop-filter"
  >
    <div
      class="baseline-end relative flex h-15 w-full items-end justify-center"
    >
      <img src="../../assets/logo.svg" class="relative h-[175%]" alt="logo" />
    </div>

    <div class="fuente-kengo mb-2 w-full text-center text-3xl">Kengo</div>

    <div class="relative">
      <form
        [formGroup]="form"
        [class.invisible]="loading()"
        [attr.aria-hidden]="loading() ? 'true' : null"
        (ngSubmit)="onSubmit()"
        class="flex w-full flex-col gap-4"
      >
        <div class="text-center">
          <p class="text-sm font-medium text-gray-700">Establece tu contraseña</p>
          <p class="mt-1 text-xs text-gray-500">
            Para acceder a tu cuenta en el futuro, necesitas una contraseña
          </p>
        </div>

        <!-- Password field -->
        <div class="flex flex-col gap-1.5">
          <label for="password" class="text-sm font-medium text-gray-700">Contraseña</label>
          <input
            id="password"
            type="password"
            formControlName="password"
            class="w-full rounded-xl border border-gray-300 bg-white px-3 py-2.5 text-base transition-all focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
            [class.border-red-500]="password.invalid && password.touched"
          />
          @if (password.hasError('required') && password.touched) {
            <span class="text-xs text-red-600">La contraseña es obligatoria.</span>
          }
          @if (password.hasError('minlength') && password.touched) {
            <span class="text-xs text-red-600">Debe tener al menos 6 caracteres.</span>
          }
        </div>

        <!-- Repeat password field -->
        <div class="flex flex-col gap-1.5">
          <label for="repetir" class="text-sm font-medium text-gray-700">Repetir contraseña</label>
          <input
            id="repetir"
            type="password"
            formControlName="repetir"
            class="w-full rounded-xl border border-gray-300 bg-white px-3 py-2.5 text-base transition-all focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
            [class.border-red-500]="repetir.invalid && repetir.touched"
          />
          @if (repetir.hasError('required') && repetir.touched) {
            <span class="text-xs text-red-600">Debes repetir la contraseña.</span>
          }
          @if (repetir.hasError('passwordMismatch') && repetir.touched) {
            <span class="text-xs text-red-600">Las contraseñas no coinciden.</span>
          }
        </div>

        <button
          type="submit"
          [disabled]="form.invalid || loading()"
          class="mt-2 flex h-12 w-full items-center justify-center rounded-xl bg-primary text-base font-semibold text-white transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-50"
        >
          Guardar y acceder
        </button>

        @if (error()) {
          <div class="rounded-lg bg-red-50 px-3 py-2 text-center text-sm text-red-600">
            {{ error() }}
          </div>
        }
      </form>

      @if (loading()) {
        <div class="absolute inset-0 flex items-center justify-center">
          <div class="h-10 w-10 animate-spin rounded-full border-4 border-primary/20 border-t-primary"></div>
        </div>
      }
    </div>
  </div>
</section>
